<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>QA Character Sheet - Vladmir Prates</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Roboto:wght@400;500&display=swap"
      rel="stylesheet"
    />

    <script src="https://unpkg.com/@panzoom/panzoom@4.5.1/dist/panzoom.min.js"></script>
    <script src="https://unpkg.com/@popperjs/core@2"></script>
    <script src="https://unpkg.com/tippy.js@6"></script>
    <link
      rel="stylesheet"
      href="https://unpkg.com/tippy.js@6/themes/light.css"
    />

    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <div class="ui-container">
      <div class="panel">
        <div class="panel-title">Attributes</div>
        <div class="stats-list">
          <div class="stat-row">
            <span class="stat-label">Class</span>
            <span class="stat-val">QA Engineer</span>
          </div>
          <div class="stat-row">
            <span class="stat-label">Level</span>
            <span class="stat-val">Mid-Level (25)</span>
          </div>
          <br />
          <div class="stat-row">
            <span class="stat-label">Automation (Int)</span>
            <span class="stat-val text-blue">215</span>
          </div>
          <div class="stat-row">
            <span class="stat-label">Manual (Str)</span>
            <span class="stat-val text-red">342</span>
          </div>
          <div class="stat-row">
            <span class="stat-label">Process (Dex)</span>
            <span class="stat-val text-green">175</span>
          </div>
          <br />
          <div class="separator"></div>
          <div style="text-align: center; color: #888; margin-bottom: 5px">
            Resistances
          </div>
          <div class="stat-row">
            <span class="stat-label">Spaghetti Code</span>
            <span class="stat-val res-poison">75% (Cap)</span>
          </div>
          <div class="stat-row">
            <span class="stat-label">Burnout</span>
            <span class="stat-val res-fire">40%</span>
          </div>
          <div class="stat-row">
            <span class="stat-label">Tight Deadlines</span>
            <span class="stat-val res-light">60%</span>
          </div>
        </div>
      </div>

      <div class="panel paper-doll">
        <div class="inventory-slot slot-w1 tall unique tooltip-right">
          <img
            src="https://game-icons.net/icons/ffffff/000000/1x1/lorc/relic-blade.svg"
            class="item-icon"
          />
          <div class="poe-tooltip">
            <div class="item-header">
              <span class="item-name">The Null Pointer</span
              ><span class="item-base">Automation Blade</span>
            </div>
            <div class="item-content">
              <div class="stat-blue">Attacks per Second: 1.85</div>
              <div class="separator"></div>
              <div>
                Adds <span class="stat-blue">10 to 20</span> Scripts per Commit
              </div>
              <div>
                <span class="stat-blue">100%</span> chance to catch Null
                Reference Exceptions
              </div>
              <div>
                Socketed Gems are supported by
                <span class="stat-white">Typescript</span>
              </div>
              <div class="flavor-text">"Undefined is not a function."</div>
            </div>
          </div>
        </div>

        <div class="inventory-slot slot-head unique tooltip-right">
          <img
            src="https://game-icons.net/icons/ffffff/000000/1x1/lorc/crown.svg"
            class="item-icon"
          />
          <div class="poe-tooltip">
            <div class="item-header">
              <span class="item-name">Crown of the Automator</span
              ><span class="item-base">QA Engineer Helmet</span>
            </div>
            <div class="item-content">
              <div class="stat-white">Experience Level: Pleno</div>
              <div class="stat-blue">Quality: +20%</div>
              <div class="separator"></div>
              <div>
                Grants Level 20
                <span class="stat-blue">Playwright Automation</span> Skill
              </div>
              <div>
                <span class="stat-blue">100%</span> Increased Bug Detection Rate
              </div>
              <div>
                Can execute
                <span class="stat-white">Functional Tests</span> autonomously
              </div>
              <div>
                Reflects <span class="stat-blue">Critical Issues</span> to
                Developers instantly
              </div>
              <div>
                Has <span class="stat-white">1 Abyssal Socket</span> (Currently:
                Robot Framework)
              </div>
              <div class="flavor-text">
                "Aqueles que vigiam o c√≥digo veem o que os criadores escolheram
                ignorar."
              </div>
            </div>
          </div>
        </div>

        <div class="inventory-slot slot-amulet small unique tooltip-left">
          <img
            src="https://game-icons.net/icons/ffffff/000000/1x1/lorc/gem-pendant.svg"
            class="item-icon"
          />
          <div class="poe-tooltip">
            <div class="item-header">
              <span class="item-name">StackOverflow Star</span
              ><span class="item-base">Onyx Amulet</span>
            </div>
            <div class="item-content">
              <div class="stat-blue">+30 to All Attributes</div>
              <div class="separator"></div>
              <div>
                Grants <span class="stat-blue">Copy/Paste Mastery</span>
              </div>
              <div>
                Cannot be <span class="stat-white">Stunned</span> by Syntax
                Errors
              </div>
              <div class="flavor-text">"Why reinvent the wheel?"</div>
            </div>
          </div>
        </div>

        <div class="inventory-slot slot-w2 tall rare tooltip-left">
          <img
            src="https://game-icons.net/icons/ffffff/000000/1x1/lorc/checked-shield.svg"
            class="item-icon"
          />
          <div class="poe-tooltip">
            <div class="item-header">
              <span class="item-name">Jira Ticket Board</span
              ><span class="item-base">Kanban Shield</span>
            </div>
            <div class="item-content">
              <div class="stat-blue">Chance to Block: 35%</div>
              <div class="separator"></div>
              <div>
                <span class="stat-blue">+80</span> to Maximum Life (Work-Life
                Balance)
              </div>
              <div>
                Reflects
                <span class="stat-white">"Works on My Machine"</span> excuses
                back to sender
              </div>
              <div>
                <span class="stat-blue">20%</span> Reduced Meeting Duration
              </div>
            </div>
          </div>
        </div>

        <div class="inventory-slot slot-ring1 small magic tooltip-right">
          <img
            src="https://game-icons.net/icons/ffffff/000000/1x1/delapouite/ring.svg"
            class="item-icon"
          />
          <div class="poe-tooltip">
            <div class="item-header">
              <span class="item-name">Git Commit</span
              ><span class="item-base">Iron Ring</span>
            </div>
            <div class="item-content">
              <div>
                Adds <span class="stat-blue">1-4</span> lines of clean code
              </div>
              <div>
                <span class="stat-blue">+20%</span> Rarity of bugs found
              </div>
            </div>
          </div>
        </div>

        <div class="inventory-slot slot-chest tall rare tooltip-right">
          <img
            src="https://game-icons.net/icons/ffffff/000000/1x1/lorc/breastplate.svg"
            class="item-icon"
          />
          <div class="poe-tooltip">
            <div class="item-header">
              <span class="item-name">Jenkins Firewall</span
              ><span class="item-base">Astral Plate</span>
            </div>
            <div class="item-content">
              <div class="stat-blue">Armour: 1205</div>
              <div class="separator"></div>
              <div>
                <span class="stat-blue">+100</span> to CI/CD Reliability
              </div>
              <div>
                <span class="stat-white">15%</span> Physical Damage Reduction
                from Scope Creep
              </div>
              <div>Has 6 Linked Sockets (Pipeline Integration)</div>
            </div>
          </div>
        </div>

        <div class="inventory-slot slot-ring2 small magic tooltip-left">
          <img
            src="https://game-icons.net/icons/ffffff/000000/1x1/delapouite/diamond-ring.svg"
            class="item-icon"
          />
          <div class="poe-tooltip">
            <div class="item-header">
              <span class="item-name">Git Push</span
              ><span class="item-base">Diamond Ring</span>
            </div>
            <div class="item-content">
              <div>
                <span class="stat-blue">20%</span> increased Quantity of
                Features
              </div>
              <div>
                Curse Enemies with
                <span class="stat-white">Merge Conflict</span> on hit
              </div>
            </div>
          </div>
        </div>

        <div class="inventory-slot slot-hands magic tooltip-right">
          <img
            src="https://game-icons.net/icons/ffffff/000000/1x1/delapouite/gloves.svg"
            class="item-icon"
          />
          <div class="poe-tooltip">
            <div class="item-header">
              <span class="item-name">Manual Testers</span
              ><span class="item-base">Silk Gloves</span>
            </div>
            <div class="item-content">
              <div class="stat-blue">Energy Shield: 45</div>
              <div class="separator"></div>
              <div><span class="stat-blue">+50</span> to Accuracy Rating</div>
              <div>
                Can spot
                <span class="stat-white">UI Misalignment</span> instantly
              </div>
            </div>
          </div>
        </div>

        <div class="inventory-slot slot-belt wide unique tooltip-right">
          <img
            src="https://game-icons.net/icons/ffffff/000000/1x1/lucasms/belt.svg"
            class="item-icon"
          />
          <div class="poe-tooltip">
            <div class="item-header">
              <span class="item-name">The Scrum Master's Sash</span
              ><span class="item-base">Leather Belt</span>
            </div>
            <div class="item-content">
              <div class="stat-white">+40 to maximum Life</div>
              <div class="separator"></div>
              <div>
                <span class="stat-blue">20%</span> increased Stand-up Speed
              </div>
              <div>
                Immune to <span class="stat-white">Blockers</span> during
                Sprints
              </div>
              <div>
                Steals <span class="stat-blue">Time Estimates</span> from
                developers
              </div>
              <div class="flavor-text">
                "Yesterday I did... Today I will do..."
              </div>
            </div>
          </div>
        </div>

        <div class="inventory-slot slot-feet rare tooltip-left">
          <img
            src="https://game-icons.net/icons/ffffff/000000/1x1/delapouite/leg-armor.svg"
            class="item-icon"
          />
          <div class="poe-tooltip">
            <div class="item-header">
              <span class="item-name">Hotfix Striders</span
              ><span class="item-base">Titan Greaves</span>
            </div>
            <div class="item-content">
              <div class="stat-blue">Armour: 220</div>
              <div class="separator"></div>
              <div>
                <span class="stat-blue">30%</span> Increased Movement Speed
              </div>
              <div>
                Cannot be Slowed by <span class="stat-white">Legacy Code</span>
              </div>
            </div>
          </div>
        </div>
        <div
          class="inventory-slot slot-pet companion unique tooltip-left"
          id="pet"
        >
          <img
            src="https://game-icons.net/icons/ffffff/000000/1x1/delapouite/plastic-duck.svg"
            class="item-icon"
          />
          <div class="poe-tooltip">
            <div class="item-header">
              <span class="item-name">Junior Rubber Duck</span
              ><span class="item-base">Legendary Companion</span>
            </div>
            <div class="item-content">
              <div class="stat-blue">Item Level: 100</div>
              <div class="separator"></div>
              <div>
                <div>
                  Absorbs <span class="stat-blue">50%</span> of Mental Stress
                </div>
                <div>Listens to your logic problems without judgment</div>
                <div><span class="stat-white">"Quack."</span></div>
                <div class="flavor-text">A lonely QA's best friend.</div>
              </div>
            </div>
          </div>
        </div>

        <div
          class="inventory-slot slot-charm1 charm magic tooltip-right"
          id="charm1"
        >
          <img
            src="https://game-icons.net/icons/ffffff/000000/1x1/lorc/rune-stone.svg"
            class="item-icon"
          />
          <div class="poe-tooltip">
            <div class="item-header">
              <span class="item-name">Stone of the Self-Taught</span
              ><span class="item-base">Small Charm</span>
            </div>
            <div class="item-content">
              <div class="stat-blue">Requires Level: Mid-Level</div>
              <div class="separator"></div>
              <div>
                <div>
                  <span class="stat-blue">+20</span> to Critical Thinking
                </div>
                <div>
                  <span class="stat-blue">50%</span> increased effectiveness of
                  <span class="stat-white">Exploratory Testing</span>
                </div>
                <div>
                  Immune to
                  <span class="stat-white">"By the Book"</span> constraints
                </div>
                <div class="flavor-text">
                  "I don't need a certificate to know it's broken."
                </div>
              </div>
            </div>
          </div>
        </div>

        <div
          class="inventory-slot slot-aura1 aura rare tooltip-left"
          id="aura1"
        >
          <img
            src="https://game-icons.net/icons/ffffff/000000/1x1/delapouite/shaking-hands.svg"
            class="item-icon"
          />
          <div class="poe-tooltip">
            <div class="item-header">
              <span class="item-name">Collaboration Aura</span>
              <span class="item-base">Passive Skill</span>
            </div>
            <div class="item-content">
              <div class="separator"></div>
              <div>
                Grants <span class="stat-blue">Empathy</span> to nearby allies
              </div>
              <div>
                Reduces Developer hostility by
                <span class="stat-blue">20%</span>
              </div>
              <div><span class="stat-white">Always Active</span></div>
            </div>
          </div>
        </div>
        <div class="flask-row">
          <div class="inventory-slot flask unique tooltip-up">
            <img
              src="https://game-icons.net/icons/ffffff/000000/1x1/lorc/coffee-mug.svg"
              class="item-icon"
              style="filter: hue-rotate(280deg)"
            />
            <div class="poe-tooltip">
              <div class="item-header">
                <span class="item-name">Emergency Coffee</span>
                <span class="item-base">Unique Flask</span>
              </div>
              <div class="item-content">
                <div class="stat-red">Consumes 100% Sanity</div>
                <div class="separator"></div>
                <div>
                  Consumes <span class="stat-blue">1</span> Charge on
                  <span class="stat-white">Critical Bug</span> discovery.
                </div>
                <div>
                  Grants <span class="stat-blue">Immunity to Sleep</span> for 4
                  hours.
                </div>
                <div class="flavor-text">
                  "Do not shake before use. Or do. I'm not a cop."
                </div>
              </div>
            </div>
          </div>
          <div class="inventory-slot flask magic tooltip-up">
            <img
              src="https://game-icons.net/icons/ffffff/000000/1x1/delapouite/water-flask.svg"
              class="item-icon"
            />
            <div class="poe-tooltip">
              <div class="item-header">
                <span class="item-name">Flask of Focus</span>
                <span class="item-base">Utility Flask</span>
              </div>
              <div class="item-content">
                Immune to <span class="stat-blue">Slack Notifications</span>
                <div class="separator"></div>
                <span class="stat-blue">40%</span> Increased Coding Speed
              </div>
            </div>
          </div>
          <div class="inventory-slot flask unique tooltip-up">
            <img
              src="https://game-icons.net/icons/ffffff/000000/1x1/lorc/bubbling-flask.svg"
              class="item-icon"
              style="filter: sepia(1)"
            />
            <div class="poe-tooltip">
              <div class="item-header">
                <span class="item-name">Tears of the Devs</span>
                <span class="item-base">Unique Flask</span>
              </div>
              <div class="item-content">
                Restores <span class="stat-white">Sanity</span> on use
              </div>
            </div>
          </div>
          <div class="inventory-slot flask magic tooltip-up">
            <img
              src="https://game-icons.net/icons/ffffff/000000/1x1/lorc/square-bottle.svg"
              class="item-icon"
            />
            <div class="poe-tooltip">
              <div class="item-header">
                <span class="item-name">Diamond Flask</span>
                <span class="item-base">Utility Flask</span>
              </div>
              <div class="item-content">
                Immune to <span class="stat-blue">Flaky Tests</span>
                <div class="separator"></div>
                Your tests become <span class="stat-blue">Lucky</span>
              </div>
            </div>
          </div>
          <div class="inventory-slot flask magic tooltip-up">
            <img
              src="https://game-icons.net/icons/ffffff/000000/1x1/lorc/fizzing-flask.svg"
              class="item-icon"
            />
            <div class="poe-tooltip">
              <div class="item-header">
                <span class="item-name">Quicksilver Flask</span>
                <span class="item-base">Utility Flask</span>
              </div>
              <div class="item-content">
                Immune to <span class="stat-blue">Freeze</span>
                <div class="separator"></div>
                <span class="stat-blue">50%</span> Increased Test Execution
                Speed <span class="stat-blue">40%</span> Increased Movement
                Speed towards the Exit on Fridays
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="panel">
        <div class="panel-title">Backpack</div>
        <div
          style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 5px"
        >
          <div
            class="inventory-slot small magic tooltip-left"
            id="backpack-scroll"
          >
            <img
              src="https://game-icons.net/icons/ffffff/000000/1x1/delapouite/scroll-quill.svg"
              class="item-icon"
            />
            <div class="poe-tooltip">
              <div class="item-header">
                <span class="item-name">Scroll of Documentation</span
                ><span class="item-base">Currency</span>
              </div>
              <div class="item-content">
                <div class="stat-blue">Stack Size: 1/40</div>
                <div class="separator"></div>
                <div>
                  Identifies <span class="stat-white">Unwritten Rules</span> of
                  the project.
                </div>
                <div>
                  Right click to learn
                  <span class="stat-blue"
                    >"How this feature actually works"</span
                  >.
                </div>
                <div class="flavor-text">"RTFM (Read The Fine Manual)."</div>
              </div>
            </div>
          </div>
          <div class="inventory-slot small">
            <div
              class="inventory-slot small rare currency tooltip-left"
              id="backpack-chaos"
            >
              <img
                src="https://game-icons.net/icons/ffffff/000000/1x1/lorc/unstable-orb.svg"
                class="item-icon"
              />
              <div class="poe-tooltip">
                <div class="item-header">
                  <span class="item-name">Orb of Environment</span>
                  <span class="item-base">Currency</span>
                </div>
                <div class="item-content">
                  <div class="stat-blue">Stack Size: 10/10</div>
                  <div class="separator"></div>
                  <div>
                    Reforges a
                    <span class="stat-white">Staging Environment</span> with new
                    random data.
                  </div>
                  <div>
                    Right click to wipe the database and
                    <span class="stat-blue">Restart the Docker Containers</span
                    >.
                  </div>
                  <div class="flavor-text">
                    "Have you tried turning it off and on again?"
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="inventory-slot small">
            <div
              class="inventory-slot small corrupted currency tooltip-left"
              id="backpack-vaal"
            >
              <img
                src="https://game-icons.net/icons/ffffff/000000/1x1/lorc/cracked-ball-dunk.svg"
                class="item-icon"
                style="filter: sepia(1) hue-rotate(-50deg) saturate(3)"
              />
              <div class="poe-tooltip">
                <div class="item-header">
                  <span class="item-name" style="color: #d20000"
                    >Orb of Hotfix</span
                  >
                  <span class="item-base">Currency</span>
                </div>
                <div class="item-content">
                  <div class="stat-blue">Stack Size: 1/10</div>
                  <div class="separator"></div>
                  <div>
                    Corrupts a <span class="stat-white">Pull Request</span>,
                    deploying it instantly.
                  </div>
                  <div>
                    <span class="stat-blue">Unpredictable Outcome:</span> May
                    fix the bug or bring down the Server.
                  </div>
                  <div class="flavor-text">"We'll test it in Production."</div>
                </div>
              </div>
            </div>
          </div>
          <div
            class="inventory-slot small unique currency tooltip-left"
            id="backpack-mirror"
          >
            <img
              src="https://game-icons.net/icons/ffffff/000000/1x1/lorc/mirror-mirror.svg"
              class="item-icon"
            />
            <div class="poe-tooltip">
              <div class="item-header">
                <span class="item-name">Mirror of Replication</span>
                <span class="item-base">Currency</span>
              </div>
              <div class="item-content">
                <div class="stat-blue">Stack Size: 1/1</div>
                <div class="separator"></div>
                <div>
                  Creates a duplicated copy of a
                  <span class="stat-white">Complex Bug</span>.
                </div>
                <div>
                  Allows the Developer to see the issue on
                  <span class="stat-blue">Localhost</span>.
                </div>
                <div class="flavor-text">
                  "It works on my machine... and now on yours too."
                </div>
              </div>
            </div>
          </div>
          <div class="inventory-slot small" style="opacity: 0.3"></div>
          <div
            class="inventory-slot small magic currency tooltip-left"
            id="backpack-whetstone"
          >
            <img
              src="https://game-icons.net/icons/ffffff/000000/1x1/lorc/rock.svg"
              class="item-icon"
            />
            <div class="poe-tooltip">
              <div class="item-header">
                <span class="item-name">Ticket Whetstone</span>
                <span class="item-base">Currency</span>
              </div>
              <div class="item-content">
                <div class="stat-blue">Stack Size: 20/20</div>
                <div class="separator"></div>
                <div>
                  Improves the <span class="stat-white">Quality</span> of a Bug
                  Report.
                </div>
                <div>
                  Adds <span class="stat-blue">+20% Clarity</span> by attaching
                  Logs and Screenshots.
                </div>
                <div class="flavor-text">
                  "Sharp details cut through developer excuses."
                </div>
              </div>
            </div>
          </div>
          <div class="inventory-slot small" style="opacity: 0.3"></div>
          <div class="inventory-slot small" style="opacity: 0.3"></div>
        </div>
        <div
          style="
            margin-top: 20px;
            color: #666;
            font-size: 12px;
            text-align: center;
          "
        >
          Currency: 40x Jira Tickets, 2x Divine Recs
        </div>
      </div>
    </div>

    <div class="bottom-bar">
      <div class="skill-container">
        <div class="skill-slot" id="skill-q">
          <span class="skill-key">Q</span>
          <img
            src="https://game-icons.net/icons/ffffff/000000/1x1/lorc/magnifying-glass.svg"
            class="skill-icon"
          />
        </div>

        <div class="skill-slot" id="skill-w">
          <span class="skill-key">W</span>
          <img
            src="https://game-icons.net/icons/ffffff/000000/1x1/delapouite/bug-net.svg"
            class="skill-icon"
          />
        </div>

        <div class="skill-slot" id="skill-e">
          <span class="skill-key">E</span>
          <img
            src="https://game-icons.net/icons/ffffff/000000/1x1/lorc/recycle.svg"
            class="skill-icon"
          />
        </div>

        <div class="skill-slot" id="skill-r">
          <span class="skill-key">R</span>
          <img
            src="https://game-icons.net/icons/ffffff/000000/1x1/delapouite/exploding-planet.svg"
            class="skill-icon"
          />
        </div>

        <div class="skill-slot" id="skill-t">
          <span class="skill-key">T</span>
          <img
            src="https://game-icons.net/icons/ffffff/000000/1x1/lorc/portal.svg"
            class="skill-icon"
          />
        </div>
      </div>

      <button class="tree-btn" onclick="openTree()">Passive Tree</button>
    </div>

    <div id="tree-modal">
      <div class="close-modal" onclick="closeTree()">X</div>

      <div
        class="section-label"
        style="
          top: 20px;
          left: 20px;
          font-size: 16px;
          opacity: 1;
          transform: none;
          z-index: 210;
        "
      >
        Points: <span id="points-counter" style="color: #c0a040">1</span>
      </div>

      <div id="tree-container">
        <div id="tree-canvas"><svg id="svg-layer"></svg></div>
      </div>
    </div>

    <script>
      // --- PASSIVE TREE LOGIC ---
      const cx = 1500,
        cy = 1500;
      const allocated = new Set(["start"]);
      let treeInitialized = false,
        panzoomInstance = null;

      const treeData = [
        // CENTER
        {
          id: "start",
          x: cx,
          y: cy,
          type: "start",
          icon: "üéØ",
          name: "QA Tester",
          desc: "The foundation of quality.",
        },
        // NORTH
        {
          id: "gm_mechanics",
          x: cx,
          y: cy - 100,
          icon: "‚öîÔ∏è",
          name: "Game Mechanics",
          desc: "Verifying damage, jumping, and core loops.",
        },
        {
          id: "gm_collision",
          x: cx,
          y: cy - 200,
          icon: "üß±",
          name: "Collision & Walls",
          desc: "Checking for invisible walls or falling through floors.",
        },
        {
          id: "gm_ui",
          x: cx - 80,
          y: cy - 200,
          icon: "üñ±Ô∏è",
          name: "UI/HUD Testing",
          desc: "Are menus readable? Do buttons actually work?",
        },
        {
          id: "gm_save",
          x: cx + 80,
          y: cy - 200,
          icon: "üíæ",
          name: "Save/Load",
          desc: "Does the game remember my progress after quitting?",
        },
        {
          id: "gm_progression",
          x: cx,
          y: cy - 300,
          icon: "üìà",
          name: "Progression",
          desc: "Unlocking levels and earning XP correctly.",
        },
        {
          id: "gm_master",
          x: cx,
          y: cy - 400,
          type: "keystone",
          icon: "üéÆ",
          name: "Player Experience",
          desc: "KEYSTONE: You verify the 'Fun' factor.",
        },
        {
          id: "gm_audio",
          x: cx - 140,
          y: cy - 150,
          icon: "üîä",
          name: "Audio & SFX",
          desc: "Is the music looping? Are footsteps synced?",
        },
        {
          id: "gm_loc",
          x: cx - 160,
          y: cy - 250,
          icon: "üè≥Ô∏è",
          name: "Localization (L10n)",
          desc: "Text overflow and missing translations.",
        },
        {
          id: "gm_physics",
          x: cx + 140,
          y: cy - 150,
          icon: "üçé",
          name: "Physics",
          desc: "Ragdolls acting crazy or objects floating.",
        },
        {
          id: "gm_tuto",
          x: cx + 160,
          y: cy - 250,
          icon: "üë∂",
          name: "Tutorials",
          desc: "FTUE: Does the game actually teach the player?",
        },
        {
          id: "gm_balance",
          x: cx,
          y: cy - 480,
          icon: "‚öñÔ∏è",
          name: "Game Balance",
          desc: "Is the boss too hard? Is the weapon too weak?",
        },
        // SOUTH
        {
          id: "bug_write",
          x: cx,
          y: cy + 100,
          icon: "üìù",
          name: "Clear Titles",
          desc: "Writing [Tag] Titles that devs understand instantly.",
        },
        {
          id: "bug_steps",
          x: cx,
          y: cy + 200,
          icon: "üë£",
          name: "Reproduction Steps",
          desc: "Exact 1-2-3 steps to make the bug happen again.",
        },
        {
          id: "bug_media",
          x: cx - 80,
          y: cy + 300,
          icon: "üì∏",
          name: "Evidence",
          desc: "Taking clear screenshots and trimming videos.",
        },
        {
          id: "bug_sev",
          x: cx + 80,
          y: cy + 300,
          icon: "‚ö†Ô∏è",
          name: "Severity & Priority",
          desc: "Knowing the difference between a Crash and a Typo.",
        },
        {
          id: "bug_master",
          x: cx,
          y: cy + 400,
          type: "keystone",
          icon: "üì´",
          name: "Perfect Ticket",
          desc: "KEYSTONE: Your tickets never get sent back as 'Cannot Reproduce'.",
        },
        {
          id: "bug_search",
          x: cx - 100,
          y: cy + 120,
          icon: "üîç",
          name: "Search Dupes",
          desc: "Checking if someone else already reported it.",
        },
        {
          id: "bug_expected",
          x: cx + 100,
          y: cy + 120,
          icon: "üÜö",
          name: "Expected Result",
          desc: "Clearly stating what *should* have happened.",
        },
        {
          id: "bug_version",
          x: cx - 120,
          y: cy + 220,
          icon: "üìå",
          name: "Version Control",
          desc: "Reporting the correct Build Number.",
        },
        {
          id: "bug_corner",
          x: cx + 120,
          y: cy + 220,
          icon: "üìê",
          name: "Corner Cases",
          desc: "Bugs that only happen in very weird situations.",
        },
        {
          id: "bug_reopen",
          x: cx,
          y: cy + 480,
          icon: "üîÅ",
          name: "Verification",
          desc: "Confirming the fix and closing the ticket.",
        },
        // EAST
        {
          id: "tech_jira",
          x: cx + 120,
          y: cy,
          icon: "üé´",
          name: "JIRA / Trello",
          desc: "Moving tickets across the board correctly.",
        },
        {
          id: "tech_logs",
          x: cx + 220,
          y: cy,
          icon: "üìú",
          name: "Grab Logs",
          desc: "Finding the player.log or output_log.txt file.",
        },
        {
          id: "tech_fps",
          x: cx + 320,
          y: cy - 60,
          icon: "üìâ",
          name: "Performance Checks",
          desc: "Noticing FPS drops in busy areas.",
        },
        {
          id: "tech_specs",
          x: cx + 320,
          y: cy + 60,
          icon: "üñ•Ô∏è",
          name: "Hardware Specs",
          desc: "Testing on Low vs High settings.",
        },
        {
          id: "tech_master",
          x: cx + 450,
          y: cy,
          type: "keystone",
          icon: "üõ†Ô∏è",
          name: "Toolbox",
          desc: "KEYSTONE: You provide the data needed to fix the bug.",
        },
        {
          id: "tech_console",
          x: cx + 250,
          y: cy - 100,
          icon: "‚å®Ô∏è",
          name: "Console Commands",
          desc: "Using cheats/debug commands to skip content.",
        },
        {
          id: "tech_net",
          x: cx + 350,
          y: cy - 120,
          icon: "üì°",
          name: "Network/Lag",
          desc: "Simulating high ping or packet loss.",
        },
        {
          id: "tech_mobile",
          x: cx + 350,
          y: cy + 120,
          icon: "üì±",
          name: "Mobile/Input",
          desc: "Touch gestures, controller disconnects, battery.",
        },
        {
          id: "tech_api",
          x: cx + 180,
          y: cy + 100,
          icon: "üîå",
          name: "Backend API",
          desc: "Checking if the server is rejecting data.",
        },
        {
          id: "tech_crash",
          x: cx + 530,
          y: cy,
          icon: "üí•",
          name: "Crash Dumps",
          desc: "Locating the .dmp files after a hard crash.",
        },
        // WEST
        {
          id: "proc_comm",
          x: cx - 120,
          y: cy,
          icon: "üó£Ô∏è",
          name: "Communication",
          desc: "Polite and clear messages to developers.",
        },
        {
          id: "proc_regr",
          x: cx - 220,
          y: cy,
          icon: "üîÑ",
          name: "Regression",
          desc: "Checking if old bugs came back after an update.",
        },
        {
          id: "proc_testplan",
          x: cx - 320,
          y: cy,
          icon: "üìã",
          name: "Test Cases",
          desc: "Following a checklist without missing items.",
        },
        {
          id: "proc_explore",
          x: cx - 420,
          y: cy,
          icon: "üß≠",
          name: "Exploratory",
          desc: "Going off-script to find unexpected issues.",
        },
        {
          id: "proc_master",
          x: cx - 550,
          y: cy,
          type: "keystone",
          icon: "üß†",
          name: "QA Mindset",
          desc: "KEYSTONE: Trust nothing. Test everything.",
        },
        {
          id: "proc_smoke",
          x: cx - 180,
          y: cy - 100,
          icon: "üí®",
          name: "Smoke Test",
          desc: "Quick check: Does the build even launch?",
        },
        {
          id: "proc_standup",
          x: cx - 280,
          y: cy - 100,
          icon: "‚òï",
          name: "Daily Standup",
          desc: "Giving concise status updates to the team.",
        },
        {
          id: "proc_docs",
          x: cx - 180,
          y: cy + 100,
          icon: "üìö",
          name: "Documentation",
          desc: "Reading the GDD/Wiki to know how it works.",
        },
        {
          id: "proc_risk",
          x: cx - 380,
          y: cy + 80,
          icon: "üí£",
          name: "Risk Analysis",
          desc: "Identifying what is most likely to break.",
        },
        {
          id: "proc_lead",
          x: cx - 630,
          y: cy,
          icon: "üëë",
          name: "QA Lead",
          desc: "Mentoring juniors and planning sprints.",
        },
      ];

      const links = [
        // Center
        { from: "start", to: "gm_mechanics" },
        { from: "start", to: "bug_write" },
        { from: "start", to: "tech_jira" },
        { from: "start", to: "proc_comm" },
        // North
        { from: "gm_mechanics", to: "gm_collision" },
        { from: "gm_mechanics", to: "gm_ui" },
        { from: "gm_mechanics", to: "gm_save" },
        { from: "gm_collision", to: "gm_progression" },
        { from: "gm_ui", to: "gm_progression" },
        { from: "gm_progression", to: "gm_master" },
        { from: "gm_ui", to: "gm_audio" },
        { from: "gm_ui", to: "gm_loc" },
        { from: "gm_mechanics", to: "gm_physics" },
        { from: "gm_progression", to: "gm_tuto" },
        { from: "gm_master", to: "gm_balance" },
        // South
        { from: "bug_write", to: "bug_steps" },
        { from: "bug_steps", to: "bug_media" },
        { from: "bug_steps", to: "bug_sev" },
        { from: "bug_media", to: "bug_master" },
        { from: "bug_sev", to: "bug_master" },
        { from: "bug_write", to: "bug_search" },
        { from: "bug_write", to: "bug_expected" },
        { from: "bug_steps", to: "bug_version" },
        { from: "bug_sev", to: "bug_corner" },
        { from: "bug_master", to: "bug_reopen" },
        // East
        { from: "tech_jira", to: "tech_logs" },
        { from: "tech_logs", to: "tech_fps" },
        { from: "tech_logs", to: "tech_specs" },
        { from: "tech_fps", to: "tech_master" },
        { from: "tech_specs", to: "tech_master" },
        { from: "tech_logs", to: "tech_console" },
        { from: "tech_fps", to: "tech_net" },
        { from: "tech_jira", to: "tech_api" },
        { from: "tech_specs", to: "tech_mobile" },
        { from: "tech_master", to: "tech_crash" },
        // West
        { from: "proc_comm", to: "proc_regr" },
        { from: "proc_regr", to: "proc_testplan" },
        { from: "proc_testplan", to: "proc_explore" },
        { from: "proc_explore", to: "proc_master" },
        { from: "proc_comm", to: "proc_smoke" },
        { from: "proc_smoke", to: "proc_standup" },
        { from: "proc_comm", to: "proc_docs" },
        { from: "proc_testplan", to: "proc_risk" },
        { from: "proc_master", to: "proc_lead" },
      ];

      function initTree() {
        if (treeInitialized) return;
        const canvas = document.getElementById("tree-canvas");
        const svg = document.getElementById("svg-layer");

        // Draw Section Labels
        const labels = [
          { text: "GAMEPLAY", x: cx, y: cy - 600 },
          { text: "BUG REPORT", x: cx, y: cy + 600 },
          { text: "TECHNICAL", x: cx + 850, y: cy },
          { text: "PROCESS", x: cx - 900, y: cy },
        ];
        labels.forEach((l) => {
          const lbl = document.createElement("div");
          lbl.className = "section-label";
          lbl.innerText = l.text;
          lbl.style.left = l.x + "px";
          lbl.style.top = l.y + "px";
          canvas.appendChild(lbl);
        });

        // Draw Lines
        links.forEach((l) => {
          const n1 = treeData.find((n) => n.id === l.from);
          const n2 = treeData.find((n) => n.id === l.to);
          const line = document.createElementNS(
            "http://www.w3.org/2000/svg",
            "line"
          );
          line.setAttribute("x1", n1.x);
          line.setAttribute("y1", n1.y);
          line.setAttribute("x2", n2.x);
          line.setAttribute("y2", n2.y);
          line.setAttribute("class", "link");
          line.setAttribute("id", `link-${l.from}-${l.to}`);
          svg.appendChild(line);
        });

        // Draw Nodes
        treeData.forEach((n) => {
          const el = document.createElement("div");
          let region = n.id.startsWith("gm_")
            ? "north"
            : n.id.startsWith("bug_")
            ? "south"
            : n.id.startsWith("tech_")
            ? "east"
            : "west";
          el.className = `node ${n.type || ""} ${region}`;
          el.id = n.id;
          el.style.left = n.x + "px";
          el.style.top = n.y + "px";
          el.innerHTML = `<span class="icon">${n.icon}</span>`;
          el.onclick = () => toggleNode(n.id);

          tippy(el, {
            content: `<div style="text-align:center; min-width: 150px;">
                        <strong style="color: #c0a040; text-transform:uppercase;">${n.name}</strong>
                        <div style="height:1px; background:#444; margin:5px 0;"></div>
                        <span style="color:#ccc; font-size: 0.9em;">${n.desc}</span>
                    </div>`,
            allowHTML: true,
            theme: "translucent",
            animation: "shift-away",
            duration: [200, 0],
            delay: [50, 0],
          });
          canvas.appendChild(el);
        });

        panzoomInstance = Panzoom(canvas, {
          maxScale: 2,
          minScale: 0.3,
          contain: "outside",
          startScale: 0.8,
        });
        document
          .getElementById("tree-container")
          .addEventListener("wheel", panzoomInstance.zoomWithWheel);

        updateVisuals();
        treeInitialized = true;
        setTimeout(
          () =>
            panzoomInstance.pan(
              -cx + window.innerWidth / 2,
              -cy + window.innerHeight / 2
            ),
          100
        );
      }

      // --- GRAPH TRAVERSAL LOGIC (BFS) ---

      // Converts the list of links into an adjacency list
      function getAdjacencyList() {
        const adj = new Map();
        treeData.forEach((node) => adj.set(node.id, new Set()));
        links.forEach((link) => {
          adj.get(link.from).add(link.to);
          adj.get(link.to).add(link.from);
        });
        return adj;
      }

      // Performs a Breadth-First Search (BFS) starting from the "start" node
      function getReachableNodes(currentAllocated) {
        const adj = getAdjacencyList();
        const reachable = new Set(["start"]);
        const queue = ["start"];

        while (queue.length > 0) {
          const currentId = queue.shift();

          adj.get(currentId).forEach((neighborId) => {
            if (
              currentAllocated.has(neighborId) &&
              !reachable.has(neighborId)
            ) {
              reachable.add(neighborId);
              queue.push(neighborId);
            }
          });
        }
        return reachable;
      }

      function toggleNode(id) {
        if (id === "start") return;

        if (allocated.has(id)) {
          // Try to unspecc
          allocated.delete(id);

          // Revalidate the tree
          const trulyReachable = getReachableNodes(allocated);

          const nodesToRemove = [];
          allocated.forEach((nodeId) => {
            if (!trulyReachable.has(nodeId)) {
              nodesToRemove.push(nodeId);
            }
          });

          nodesToRemove.forEach((nodeId) => allocated.delete(nodeId));
        } else {
          // Try to allocate
          // Verify if any adjacent node is allocated
          const adj = getAdjacencyList();
          const neighbors = adj.get(id);
          let isReachable = false;

          for (const neighborId of neighbors) {
            if (allocated.has(neighborId)) {
              isReachable = true;
              break;
            }
          }

          if (isReachable) {
            allocated.add(id);
          }
        }
        updateVisuals();
      }

      function updateVisuals() {
        treeData.forEach((n) => {
          const el = document.getElementById(n.id);
          if (allocated.has(n.id)) {
            el.classList.add("allocated");
            // add class 'Allocated' on Keystone
            if (n.type === "keystone") el.classList.add("allocated");
          } else {
            el.classList.remove("allocated");
          }
        });
        links.forEach((l) => {
          const line = document.getElementById(`link-${l.from}-${l.to}`);
          if (allocated.has(l.from) && allocated.has(l.to))
            line.classList.add("active");
          else line.classList.remove("active");
        });
        const counter = document.getElementById("points-counter");
        if (counter) counter.innerText = allocated.size - 1;
      }

      function openTree() {
        document.getElementById("tree-modal").style.display = "block";
        if (!treeInitialized) initTree();
      }
      function closeTree() {
        document.getElementById("tree-modal").style.display = "none";
      }

      document.addEventListener("DOMContentLoaded", function () {
        // Common Config
        const commonConfig = {
          allowHTML: true,
          placement: "top",
          animation: "shift-away",
          interactive: true,
          duration: [200, 0],
          delay: [50, 0],
        };

        // 1. Inspect Element (Q)
        tippy("#skill-q", {
          ...commonConfig,
          content: `
        <div class="poe-tooltip" style="display: block !important; position: static !important; visibility: visible !important; opacity: 1 !important;">
          <div class="item-header">
            <span class="item-name">Inspect Element</span>
            <span class="item-base">Intelligence Skill</span>
          </div>
          <div class="item-content">
            <div class="stat-blue">Mana Cost: 5 Coffee</div>
            <div class="stat-white">Cast Time: Instant</div>
            <div class="separator"></div>
            <div>Reveals hidden <span class="stat-blue">DOM Properties</span>.</div>
            <div>Allows you to delete annoying overlays.</div>
            <div><span class="stat-blue">50%</span> chance to feel like a hacker.</div>
            <div class="flavor-text">"It's not a bug, it's a feature... until I delete the div."</div>
          </div>
        </div>
      `,
        });

        // 2. Capture Bug (W)
        tippy("#skill-w", {
          ...commonConfig,
          content: `
        <div class="poe-tooltip" style="display: block !important; position: static !important; visibility: visible !important; opacity: 1 !important;">
          <div class="item-header">
            <span class="item-name">Capture Bug</span>
            <span class="item-base">Dexterity Skill</span>
          </div>
          <div class="item-content">
            <div class="stat-blue">Cooldown: 2 Seconds</div>
            <div class="separator"></div>
            <div>Creates a <span class="stat-white">Jira Ticket</span> target.</div>
            <div>Applying <span class="stat-blue">"Steps to Reproduce"</span> freezes the Developer.</div>
            <div>Screenshots gain <span class="stat-blue">+20%</span> clarity.</div>
            <div class="flavor-text">"Gotta catch 'em all."</div>
          </div>
        </div>
      `,
        });

        // 3. Automated Regression (E)
        tippy("#skill-e", {
          ...commonConfig,
          content: `
        <div class="poe-tooltip" style="display: block !important; position: static !important; visibility: visible !important; opacity: 1 !important;">
          <div class="item-header">
            <span class="item-name">Automated Regression</span>
            <span class="item-base">Spell Totem</span>
          </div>
          <div class="item-content">
            <div class="stat-blue">Mana Cost: 100% Patience</div>
            <div class="separator"></div>
            <div>Summons a <span class="stat-white">Pipeline</span> to fight for you.</div>
            <div>Deals <span class="stat-blue">Mental Damage</span> to whoever broke the build.</div>
            <div><span class="stat-red" style="color:#ff5555">WARNING:</span> May fail randomly (Flaky).</div>
            <div class="flavor-text">"If it happens once, it's an accident. If it happens twice, write a script."</div>
          </div>
        </div>
      `,
        });

        // 4. Break Production (R)
        tippy("#skill-r", {
          ...commonConfig,
          content: `
        <div class="poe-tooltip" style="display: block !important; position: static !important; visibility: visible !important; opacity: 1 !important;">
          <div class="item-header">
            <span class="item-name">Break Production</span>
            <span class="item-base">Vaal Ultimate</span>
          </div>
          <div class="item-content">
            <div class="stat-red" style="color:#ff5555">Souls Per Use: 1 Career</div>
            <div class="separator"></div>
            <div><span class="stat-blue">100%</span> Global Critical Strike Chance.</div>
            <div>Causes <span class="stat-red" style="color:#ff5555">Mass Panic</span> in the Slack Channel.</div>
            <div>Summons <span class="stat-white">The Manager</span> (Level 100 Boss).</div>
            <div>Cannot be evaded.</div>
            <div class="flavor-text">"I just wanted to see what this button does..."</div>
          </div>
        </div>
      `,
        });

        // 5. Teleport to Meeting (T)
        tippy("#skill-t", {
          ...commonConfig,
          content: `
        <div class="poe-tooltip" style="display: block !important; position: static !important; visibility: visible !important; opacity: 1 !important;">
          <div class="item-header">
            <span class="item-name">Teleport to Meeting</span>
            <span class="item-base">Utility Spell</span>
          </div>
          <div class="item-content">
            <div class="stat-blue">Duration: Too Long</div>
            <div class="separator"></div>
            <div>Escapes current work context.</div>
            <div>Reduces <span class="stat-blue">Productivity</span> by 75%.</div>
            <div>Grants buff: <span class="stat-white">"Sorry, I was on mute."</span></div>
            <div class="flavor-text">"Could this have been an email?"</div>
          </div>
        </div>
      `,
        });
      });
    </script>
  </body>
</html>
